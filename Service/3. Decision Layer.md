# ğŸ“¡ Module 03: Decision Layer & AI Logic
> **Project:** 6G-Guardian (ISAC-based Contactless Athlete Protection System)  
> **Module:** AI Inference, Digital Twin, Decision Logic  
> **Version:** 1.0.0 (Deep Technical Specification)  
> **Author:** Mobile Engineering Dept. KNU

---

## 1. ì„œë¡  (Introduction)

### 1.1. ê°œìš” (Overview)
**Decision Layer**ëŠ” Infrastructure Layerë¡œë¶€í„° ìˆ˜ì‹ ëœ Semantic Feature(ì˜ë¯¸ ì •ë³´)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì‹œê°„ ì¶”ë¡ (Inference)ì„ ìˆ˜í–‰í•˜ëŠ” ìµœìƒìœ„ ë…¼ë¦¬ ê³„ì¸µì´ë‹¤.
ë³¸ ëª¨ë“ˆì€ **Spatio-Temporal Graph Neural Network (ST-GCN)**ì™€ **Transformer** ì•„í‚¤í…ì²˜ë¥¼ ê²°í•©í•˜ì—¬ ì„ ìˆ˜ì˜ ë™ì‘ê³¼ ìƒì²´ ì‹ í˜¸ë¥¼ ë¶„ì„í•˜ë©°, **Personalized Digital Twin(ê°œì¸í™” ë””ì§€í„¸ íŠ¸ìœˆ)** ê¸°ìˆ ì„ í†µí•´ ì„ ìˆ˜ ê°œê°œì¸ì˜ ê³ ìœ í•œ ì‹ ì²´ íŠ¹ì„±ì„ ë°˜ì˜í•œ ì •ë°€í•œ ìœ„í—˜ë„(Risk Score) ì‚°ì¶œì„ ìˆ˜í–‰í•œë‹¤.

---

## 2. AI ëª¨ë¸ ì•„í‚¤í…ì²˜ (AI Model Architecture)

ë³¸ ì‹œìŠ¤í…œì€ ë‹¤ì¤‘ ëª¨ë‹¬(Multi-modal) ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ 3ê°€ì§€ ì „ë¬¸í™”ëœ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ì˜ ì•™ìƒë¸”(Ensemble) êµ¬ì¡°ë¥¼ ì±„íƒí•œë‹¤.



### 2.1. Skeletal Analysis Model: ST-GCN
ê´€ì ˆì˜ ì›€ì§ì„(Kinematics)ì„ ë¶„ì„í•˜ì—¬ êµ¬ì¡°ì  ë¶€ìƒ ìœ„í—˜ì„ ê°ì§€í•œë‹¤.
* **Algorithm:** **Spatio-Temporal Graph Convolutional Network (ST-GCN)**.
* **Input:** $N$ê°œì˜ ê´€ì ˆ(Node)ê³¼ ë¼ˆ(Edge)ë¡œ êµ¬ì„±ëœ ì‹œê³„ì—´ ê·¸ë˜í”„ ë°ì´í„° ($T \times V \times C$).
    * $T$: Time Frames (Window size: 30~60 frames).
    * $V$: Vertices (19 Keypoints).
    * $C$: Channels (x, y, z Coordinates + Confidence).
* **Operation:**
    * **Spatial Graph Conv:** í”„ë ˆì„ ë‚´ì—ì„œ ì¸ì ‘í•œ ê´€ì ˆ ê°„ì˜ ìƒê´€ê´€ê³„ ë¶„ì„ (ì˜ˆ: ë¬´ë¦ê³¼ ë°œëª©ì˜ ì•µê¸€).
    * **Temporal Conv:** ì‹œê°„ ì¶•ì„ ë”°ë¼ ë™ì‘ì˜ íë¦„ê³¼ ê°€ì†ë„ ë³€í™” ë¶„ì„.
* **Output:** Action Class (Running, Falling, Abnormal) & Joint Stress Vector.

### 2.2. Tremor Detection Model: Hybrid CNN-Transformer
ë§ˆì´í¬ë¡œ ë„í”ŒëŸ¬ ìŠ¤í™íŠ¸ë¡œê·¸ë¨(ì´ë¯¸ì§€)ì—ì„œ ë¯¸ì„¸ ë–¨ë¦¼ íŒ¨í„´ì„ ì°¾ì•„ë‚¸ë‹¤.
* **Algorithm:** **CNN Backbone (ResNet-18) + Transformer Encoder**.
* **Input:** Micro-Doppler Spectrogram (Time-Frequency Image).
* **Mechanism:**
    1.  **CNN:** ì´ë¯¸ì§€ì—ì„œ ë¡œì»¬ íŠ¹ì§•(Local Features, ë–¨ë¦¼ì˜ ì£¼íŒŒìˆ˜ ëŒ€ì—­) ì¶”ì¶œ.
    2.  **Transformer (Self-Attention):** ì‹œê³„ì—´ì  ë¬¸ë§¥(Context)ì„ íŒŒì•…í•˜ì—¬ ì¼ì‹œì ì¸ ë…¸ì´ì¦ˆì¸ì§€, ì§€ì†ì ì¸ **ë³‘ë¦¬í•™ì  ë–¨ë¦¼(Pathological Tremor)**ì¸ì§€ êµ¬ë¶„.
    * **Attention Mechanism:** $\text{Attention}(Q, K, V) = \text{softmax}(\frac{QK^T}{\sqrt{d_k}})V$.
* **Target:** 8~12Hz ëŒ€ì—­ì˜ ë¹„ì •ìƒ ì§„ë™ íŒ¨í„´ ê°ì§€.

### 2.3. Digital Twin Comparator (Baseline Comparison)
* **Concept:** ëª¨ë“  ì„ ìˆ˜ì—ê²Œ ë™ì¼í•œ ê¸°ì¤€ì„ ì ìš©í•˜ì§€ ì•Šê³ , ì„ ìˆ˜ ê°œì¸ë³„ **'ì •ìƒ ìƒíƒœ ëª¨ë¸(Baseline Model)'**ì„ êµ¬ì¶•.
* **Technology:** **Few-shot Learning / Online Learning**.
* **Process:**
    * ê²½ê¸° ì „ ì›œì—… ë°ì´í„°ë¥¼ í†µí•´ í•´ë‹¹ ì„ ìˆ˜ì˜ í‰ì†Œ ê°€ë™ ë²”ìœ„(RoM), ë³´í–‰ ëŒ€ì¹­ì„±, ì‹¬ë°• íŒ¨í„´ì„ í•™ìŠµ.
    * ì‹¤ì‹œê°„ ë°ì´í„°ì™€ Baseline ê°„ì˜ **KL-Divergence (Kullback-Leibler Divergence)**ë¥¼ ê³„ì‚°í•˜ì—¬ ì´ìƒì¹˜(Anomaly) ì •ë„ë¥¼ ì •ëŸ‰í™”.

---

## 3. ì˜ì‚¬ê²°ì • ë¡œì§ ë° ì•Œê³ ë¦¬ì¦˜ (Decision Logic & Algorithm)

AI ëª¨ë¸ì˜ ì¶œë ¥ê°’ì„ ì¢…í•©í•˜ì—¬ ìµœì¢…ì ìœ¼ë¡œ "ê²½ê¸° ì¤‘ë‹¨" ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ëŠ” ìˆ˜í•™ì  ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.

### 3.1. í†µí•© ìœ„í—˜ë„ ì ìˆ˜ ì‚°ì¶œ (Total Risk Scoring)
ìµœì¢… ìœ„í—˜ ì ìˆ˜ $R_{total}$ì€ ì„¸ ê°€ì§€ ìš”ì¸ì˜ ê°€ì¤‘ í•©ìœ¼ë¡œ ê³„ì‚°ëœë‹¤.

$$R_{total}(t) = w_1 \cdot R_{kin}(t) + w_2 \cdot R_{trem}(t) + w_3 \cdot R_{vit}(t)$$

* **$R_{kin}$ (ìš´ë™í•™ì  ìœ„í—˜ë„):** ST-GCN ì¶œë ¥. ê´€ì ˆ êº¾ì„ ê°ë„ $\theta$ê°€ ì„ê³„ì¹˜ $\theta_{th}$ë¥¼ ì´ˆê³¼í•˜ëŠ” ì •ë„.
    * $R_{kin} = \text{Sigmoid}(\alpha (\theta_{current} - \theta_{th}))$
* **$R_{trem}$ (ë–¨ë¦¼ ìœ„í—˜ë„):** Transformer ì¶œë ¥. ê·¼ìœ¡ ê²½ë ¨ í™•ë¥  ($0 \sim 1$).
* **$R_{vit}$ (ë°”ì´íƒˆ ìœ„í—˜ë„):** ì‹¬ë°•/í˜¸í¡ì˜ ë¹„ì •ìƒ ë³€ë™ì„±.
* **$w_1, w_2, w_3$:** ê°€ì¤‘ì¹˜ (ìƒí™©ì— ë”°ë¼ ë™ì  ì¡°ì •, $\sum w_i = 1$).

### 3.2. íŒë‹¨ íë¦„ë„ (Decision Flowchart)

1.  **Level 1: Pre-Warning (ì£¼ì˜)**
    * Condition: $50 \le R_{total} < 75$.
    * Action: ì½”ì¹­ ìŠ¤íƒœí”„ íƒœë¸”ë¦¿ì— **"Yellow Alert"** ì „ì†¡. (ì˜ˆ: "Player #7 í–„ìŠ¤íŠ¸ë§ í”¼ë¡œë„ ëˆ„ì  ì¤‘")
2.  **Level 2: Critical Warning (ê²½ê³ )**
    * Condition: $75 \le R_{total} < 90$.
    * Action: ì˜ë£Œì§„ì—ê²Œ **"Red Alert"** ì „ì†¡ ë° í•´ë‹¹ ë¶€ìœ„(ì™¼ìª½ ë¬´ë¦ ë“±) í•˜ì´ë¼ì´íŠ¸.
3.  **Level 3: Game Stop (ê²½ê¸° ì¤‘ë‹¨)**
    * Condition: $R_{total} \ge 90$ OR **Detect Acute Event** (e.g., ACL Tear Signal).
    * Action: ì‹¬íŒì˜ ì›¨ì–´ëŸ¬ë¸” ê¸°ê¸°ì— ì§„ë™ ë° **"STOP"** ì‹ í˜¸ ì¦‰ì‹œ ì „ì†¡. ìë™í™”ëœ ë“œë¡ /ì¹´ë©”ë¼ê°€ í•´ë‹¹ ì„ ìˆ˜ í¬ì»¤ì‹±.

---

## 4. ì„±ëŠ¥ ìµœì í™” ë° ì—£ì§€ ì»´í“¨íŒ… (Performance Optimization)

0.1msê¸‰ ì´ˆì €ì§€ì—° ì˜ì‚¬ê²°ì •ì„ ìœ„í•œ ì†Œí”„íŠ¸ì›¨ì–´ ìµœì í™” ê¸°ìˆ ì´ë‹¤.

### 4.1. Model Quantization (ëª¨ë¸ ê²½ëŸ‰í™”)
* **Technique:** FP32(32-bit Floating Point) ëª¨ë¸ì„ **INT8(8-bit Integer)**ë¡œ ì–‘ìí™”.
* **Tool:** NVIDIA TensorRT.
* **Effect:** ì¶”ë¡  ì†ë„ 4ë°° í–¥ìƒ, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 1/4 ê°ì†Œ, ì •í™•ë„ ì†ì‹¤ 1% ë¯¸ë§Œ.

### 4.2. Pipelining & Parallelism
* **Approach:** ì„¼ì‹± ë°ì´í„° ìˆ˜ì‹ (I/O), ì „ì²˜ë¦¬(CPU), ëª¨ë¸ ì¶”ë¡ (GPU)ì„ ë³‘ë ¬ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ì²˜ë¦¬.
* **Throughput:** ì´ˆë‹¹ 1000 í”„ë ˆì„(FPS) ì´ìƒ ì²˜ë¦¬ ê°€ëŠ¥í•˜ì—¬ ë‹¤ìˆ˜ ì„ ìˆ˜ì˜ ë™ì‹œ ì¶”ì  ë³´ì¥.

---

## 5. ë°ì´í„°ì…‹ ë° í•™ìŠµ ì „ëµ (Dataset & Training Strategy)

### 5.1. Training Data
ë³¸ ëª¨ë¸ í•™ìŠµì„ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤í”ˆ ë°ì´í„°ì…‹ê³¼ ìì²´ êµ¬ì¶• ë°ì´í„°ë¥¼ í™œìš©í•œë‹¤.
* **NTU RGB+D 120:** ëŒ€ê·œëª¨ 3D í–‰ë™ ì¸ì‹ ë°ì´í„°ì…‹ (ST-GCN í•™ìŠµìš©).
* **RadHAR (Radar Human Activity Recognition):** ë ˆì´ë” ê¸°ë°˜ í–‰ë™ ì¸ì‹ ë°ì´í„°ì…‹.
* **Simulated Data:** Unity/Unreal Engine ê¸°ë°˜ì˜ ë¬¼ë¦¬ ì—”ì§„ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ í¬ê·€ ë¶€ìƒ ì¼€ì´ìŠ¤(ê³¨ì ˆ, ì‹¤ì‹  ë“±) ë°ì´í„° ìƒì„±.

### 5.2. Federated Learning (ì—°í•© í•™ìŠµ) - *Optional*
* **Concept:** ê° êµ¬ë‹¨ì˜ ë¯¼ê°í•œ ì„ ìˆ˜ ë°ì´í„°ëŠ” ë¡œì»¬ ì„œë²„ì—ì„œë§Œ í•™ìŠµí•˜ê³ , ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜(Weight)ë§Œ ì¤‘ì•™ ì„œë²„ë¡œ ê³µìœ .
* **Privacy:** ì„ ìˆ˜ì˜ ê°œì¸ ì˜ë£Œ ì •ë³´ ë³´í˜¸ ê·œì •(GDPR/HIPAA) ì¤€ìˆ˜.

---

## 6. ê²°ë¡  (Conclusion)

Decision LayerëŠ” ë‹¨ìˆœí•œ ê·œì¹™ ê¸°ë°˜(Rule-based) ì‹œìŠ¤í…œì„ ë„˜ì–´, **Deep Learning**ê³¼ **Digital Twin** ê¸°ìˆ ì„ ê²°í•©í•˜ì—¬ ìƒí™© ë§¥ë½(Context)ì„ ì´í•´í•˜ëŠ” ì§€ëŠ¥í˜• ì‹œìŠ¤í…œì´ë‹¤.
íŠ¹íˆ **ST-GCN**ì„ í†µí•œ êµ¬ì¡°ì  ë¶„ì„ê³¼ **Transformer**ë¥¼ í†µí•œ ì‹œê³„ì—´ì  ì´ìƒ ê°ì§€ì˜ ê²°í•©ì€, ì¸ê°„ ì‹¬íŒì´ ì¸ì§€í•  ìˆ˜ ì—†ëŠ” 0.1ì´ˆ ì°°ë‚˜ì˜ ë¶€ìƒ ì§•í›„ë¥¼ ì •í™•íˆ í¬ì°©í•˜ì—¬ ìŠ¤í¬ì¸  ì•ˆì „ì˜ ìƒˆë¡œìš´ í‘œì¤€ì„ ì œì‹œí•œë‹¤.

---

## 7. ì°¸ê³  ë¬¸í—Œ (References)

1.  **"Spatial Temporal Graph Convolutional Networks for Skeleton-Based Action Recognition"** (S. Yan et al., AAAI 2018)
    * *Core Algorithm:* ST-GCN ì•„í‚¤í…ì²˜ ì›ì „.
2.  **"Attention Is All You Need"** (Vaswani et al., NIPS 2017)
    * *Core Algorithm:* Transformer ë° Self-Attention ë©”ì»¤ë‹ˆì¦˜.
3.  **"Deep Learning for Sensor-based Activity Recognition: A Survey"** (L. Wang et al.)
    * *Context:* ì„¼ì„œ ë°ì´í„°(Time-series) ì²˜ë¦¬ ë”¥ëŸ¬ë‹ ê¸°ë²•.
4.  **"Digital Twin: Values, Challenges and Enablers"** (IEEE Access)
    * *Concept:* ë””ì§€í„¸ íŠ¸ìœˆì˜ ê°œë… ë° í—¬ìŠ¤ì¼€ì–´ ì ìš© ì‚¬ë¡€.

---
*Created by [Your Name] for 6G-Guardian Project.*
