# ğŸ“¡ Module 03: Autonomous AI Agent & Implementation Spec
> **Project:** 6G-Guardian (ISAC-based Contactless Athlete Protection System)  
> **Module:** AI Implementation, Open-Source Stack, RL Control  
> **Version:** 3.0.0 (Implementation-Ready)  
> **Author:** Team BAESTRO, Mobile Engineering Dept. KNU

---

## 1. ì„œë¡  (Introduction)

### 1.1. ê°œìš” (Overview)
ë³¸ ë¬¸ì„œëŠ” 6G-Guardian ì‹œìŠ¤í…œì˜ ë‘ë‡Œì¸ **Autonomous AI Agent**ì˜ êµ¬ì²´ì ì¸ êµ¬í˜„ ë°©ì•ˆì„ ê¸°ìˆ í•œë‹¤.
ë³¸ ì—ì´ì „íŠ¸ëŠ” ë‹¨ìˆœí•œ ê·œì¹™ ê¸°ë°˜ ì‹œìŠ¤í…œì´ ì•„ë‹Œ, **ì‹¬ì¸µ ê°•í™”í•™ìŠµ(Deep RL)**ì„ í†µí•´ ì¸í”„ë¼ë¥¼ ëŠ¥ë™ ì œì–´(Active Control)í•˜ëŠ” ììœ¨ ì‹œìŠ¤í…œì´ë‹¤. ì´ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ ê²€ì¦ëœ SOTA(State-of-the-Art) ì˜¤í”ˆì†ŒìŠ¤ ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ, 6G RF ë°ì´í„° íŠ¹ì„±ì— ë§ì¶˜ **Knowledge Distillation(ì§€ì‹ ì¦ë¥˜)** ë° **Physics-Informed(ë¬¼ë¦¬ ì •ë³´)** í•™ìŠµ ê¸°ë²•ì„ ì ìš©í•œë‹¤.

---

## 2. AI ëª¨ë¸ êµ¬í˜„ ìƒì„¸ (Implementation Specification)

4ê°œì˜ í•µì‹¬ ëª¨ë“ˆì— ëŒ€í•œ ì‚¬ìš© ëª¨ë¸, ë¼ì´ë¸ŒëŸ¬ë¦¬, íŠœë‹ ì „ëµ ëª…ì„¸ì„œì´ë‹¤.

### 2.1. Skeletal Kinematics Module (ê³¨ê²© ë³µì›)
ë¶ˆì™„ì „í•˜ê³  í¬ì†Œí•œ(Sparse) 6G ë ˆì´ë” í¬ì¸íŠ¸ í´ë¼ìš°ë“œë¥¼ 3D ê³¨ê²©ìœ¼ë¡œ ë³€í™˜í•œë‹¤.

* **Backbone Model:** **PointNet++** (Feature Extractor) + **DGCNN** (Dynamic Graph CNN).
* **Library:** `PyTorch Geometric (PyG)` / `OpenMMLab MMPose`.
* **Engineering Strategy (Knowledge Distillation):**
    * **Problem:** RF ì‹ í˜¸ëŠ” ê´‘í•™ ì¹´ë©”ë¼ë³´ë‹¤ í•´ìƒë„ê°€ ë‚®ì•„ ê³¨ê²© ì¶”ì¶œì´ ì–´ë ¤ì›€.
    * **Solution:** **'Cross-Modal Distillation'** ê¸°ë²• ì ìš©.
        1.  **Teacher (Optical):** `NTU RGB+D 120` ë°ì´í„°ì…‹ìœ¼ë¡œ í•™ìŠµëœ ê³ ì •ë°€ ì¹´ë©”ë¼ ëª¨ë¸.
        2.  **Student (RF):** 6G ë ˆì´ë” ëª¨ë¸.
        3.  **Process:** Teacherê°€ ì¶”ì¶œí•œ Feature Mapì„ Studentê°€ ëª¨ë°©í•˜ë„ë¡ Loss Functionì„ ì„¤ê³„í•˜ì—¬ í•™ìŠµ íš¨ìœ¨ ê·¹ëŒ€í™”.

### 2.2. Micro-Tremor Detection Module (ë–¨ë¦¼ ê°ì§€)
ë§ˆì´í¬ë¡œ ë„í”ŒëŸ¬ ìŠ¤í™íŠ¸ë¡œê·¸ë¨ ì´ë¯¸ì§€ì—ì„œ ë¹„ì •ìƒ ì£¼íŒŒìˆ˜ íŒ¨í„´ì„ ë¶„ë¥˜í•œë‹¤.

* **Backbone Model:** **EfficientNet-V2 (Small)**.
    * *Why?* ResNet ëŒ€ë¹„ íŒŒë¼ë¯¸í„° ìˆ˜ê°€ ì ì–´ 0.1ms ì´ˆì €ì§€ì—° ì¶”ë¡ (Edge Inference)ì— ìµœì í™”ë¨.
* **Library:** `Timm (PyTorch Image Models)`.
* **Engineering Strategy (Data Augmentation):**
    * **Problem:** ì‹¤ì œ ê·¼ìœ¡ ê²½ë ¨(Cramp) ë°ì´í„° í™•ë³´ì˜ ì–´ë ¤ì›€.
    * **Solution:** **'SpecAugment'** ë° **'Contrastive Learning'** ì ìš©.
        1.  **SpecAugment:** ìŠ¤í™íŠ¸ë¡œê·¸ë¨ì˜ ì‹œê°„/ì£¼íŒŒìˆ˜ ì¶•ì„ ë§ˆìŠ¤í‚¹(Masking)í•˜ì—¬ ë°ì´í„° ì¦ê°•.
        2.  **SimCLR:** ë¼ë²¨ì´ ì—†ëŠ” ìƒíƒœì—ì„œ 'ì •ìƒ ê·¼ìœ¡ ìˆ˜ì¶•'ê³¼ 'ë¹„ì •ìƒ ë–¨ë¦¼'ì˜ íŠ¹ì§• ì°¨ì´ë¥¼ ìŠ¤ìŠ¤ë¡œ í•™ìŠµ(Self-Supervised)í•˜ê²Œ í•œ í›„ Fine-tuning.

### 2.3. Physiological Inference Module (ì‹¬ë¶€ ì˜¨ë„/ìˆ˜ë¶„)
ë°ì´í„°ê°€ ì—†ëŠ” ì˜ì—­ì—ì„œë„ ë¬¼ë¦¬ ë²•ì¹™ì„ ìœ„ë°°í•˜ì§€ ì•Šë„ë¡ ê°•ì œí•œë‹¤.

* **Model Architecture:** **PINN (Physics-Informed Neural Network)**.
* **Library:** `DeepXDE` (Scientific ML Library).
* **Engineering Strategy (Physics Regularization):**
    * **Loss Function Design:** ë°ì´í„° ì˜¤ì°¨($MSE_{data}$)ì— ë¬¼ë¦¬ ë°©ì •ì‹ ì”ì°¨($MSE_{physics}$)ë¥¼ ì¶”ê°€.
    $$Loss = MSE_{data} + \lambda \cdot || \mathcal{N}_{Pennes}(T) ||^2$$
    * $\mathcal{N}_{Pennes}$: íœìŠ¤ ìƒì²´ ì—´ ë°©ì •ì‹(Pennes' Bio-heat Eq) ì—°ì‚°ì.
    * ì´ë¥¼ í†µí•´ í”¼ë¶€ ì˜¨ë„($T_s$) ë°ì´í„°ë§Œìœ¼ë¡œ ì‹¬ë¶€ ì˜¨ë„($T_b$)ë¥¼ ì •í™•íˆ ì—­ì‚°ì¶œ.

### 2.4. Autonomous Control Agent (ê°•í™”í•™ìŠµ ì œì–´)
ìƒí™©ì— ë”°ë¼ 6G ë¹”í¬ë°ì„ ì œì–´í•˜ê³  ê²½ê¸°ë¥¼ ì¤‘ë‹¨ì‹œí‚¤ëŠ” ì˜ì‚¬ê²°ì •ì²´.

* **Algorithm:** **PPO (Proximal Policy Optimization)**.
    * *Why?* DQN ëŒ€ë¹„ í•™ìŠµ ì•ˆì •ì„±ì´ ë†’ê³ , ì—°ì†ì ì¸ ì œì–´(Continuous Action Space)ì— ìœ ë¦¬í•¨.
* **Library:** `Stable Baselines3` (RL Algorithm) / `Ray RLLib` (Distributed Training).
* **Environment:** `Unity ML-Agents` (Sim-to-Real).
* **Reward System:**
    * **(+) Reward:** ë¶€ìƒ ì§•í›„ ì¡°ê¸° í¬ì°© (+10), ì •í™•í•œ ìœ„í—˜ë„ ì˜ˆì¸¡ (+5).
    * **(-) Penalty:** ì˜¤ì‘ë™/False Alarm (-5), ë¶€ìƒ ë†“ì¹¨ (-20), ì»´í“¨íŒ… ìì› ê³¼ë‹¤ ì‚¬ìš© (-1).

---

## 3. ì—ì´ì „íŠ¸ ë£¨í”„ ë° ì˜ì‚¬ê²°ì • (Agent Loop & MDP)

ì—ì´ì „íŠ¸ëŠ” **MDP (Markov Decision Process)** ê¸°ë°˜ì˜ íë£¨í”„(Closed-loop) ì œì–´ë¥¼ ìˆ˜í–‰í•œë‹¤.

### Step 1: Observation ($S_t$)
* 4ê°œ ëª¨ë“ˆ(ê³¨ê²©, ë–¨ë¦¼, ì²´ì˜¨, ìˆ˜ë¶„)ì˜ ì¶œë ¥ ë²¡í„° ë° ì‹ ë¢°ë„(Confidence Score) ìˆ˜ì§‘.
* ìƒíƒœ ë²¡í„° $S_t = [v_{skel}, v_{tremor}, v_{temp}, v_{hyd}, c_{conf}]$.

### Step 2: Policy Reasoning ($A_t \sim \pi(S_t)$)
* PPO ì •ì±… ì‹ ê²½ë§ì´ í˜„ì¬ ìƒíƒœì—ì„œ ìµœì ì˜ í–‰ë™ì„ í™•ë¥ ì ìœ¼ë¡œ ì„ íƒ.
* **Case A (ë¶ˆí™•ì‹¤):** ì‹ ë¢°ë„ $c_{conf} < 0.6$ $\rightarrow$ **Action: Active Sensing** (ë¹”í¬ë° ì§‘ì¤‘, RIS ê°ë„ ë³€ê²½).
* **Case B (ìœ„í—˜ ê°ì§€):** ìœ„í—˜ë„ $R_{total} > 0.9$ $\rightarrow$ **Action: Game Stop** (ì‹¬íŒ ì•Œë¦¼ ì „ì†¡).

### Step 3: Execution & Feedback
* ì„ íƒëœ í–‰ë™ì„ 6G ì¸í”„ë¼(RU/MEC)ì— ëª…ë ¹í•˜ê³ , ë³€í™”ëœ í™˜ê²½($S_{t+1}$)ì„ ë‹¤ì‹œ ê´€ì¸¡.

---

## 4. ìœ„í—˜ë„ ì‚°ì¶œ ë¡œì§ (Total Risk Scoring)

ìµœì¢… íŒë‹¨ì„ ìœ„í•œ ì •ëŸ‰ì  ì§€í‘œ ê³„ì‚°ì‹ì´ë‹¤.

$$R_{total}(t) = w_1 \cdot R_{kin}(t) + w_2 \cdot R_{trem}(t) + w_3 \cdot R_{vit}(t)$$

* **$R_{kin}$ (ST-GCN Output):** ê´€ì ˆ ê³¼ì‹ ì „ ë° ë¹„ì •ìƒ ì¶©ê²©ëŸ‰ (0.0~1.0).
* **$R_{trem}$ (EfficientNet Output):** ë³‘ë¦¬í•™ì  ë–¨ë¦¼ í™•ë¥  (Softmax Score).
* **$R_{vit}$ (PINN Output):** ì—´ì‚¬ë³‘($T_b > 39.5^\circ C$) ë° íƒˆìˆ˜($\text{Loss} > 2\%$) ìœ„í—˜ë„.
* **Adaptive Weights ($w_i$):** ê°•í™”í•™ìŠµ ì—ì´ì „íŠ¸ê°€ ìƒí™©(Context)ì— ë”°ë¼ ê°€ì¤‘ì¹˜ë¥¼ ë™ì ìœ¼ë¡œ ì¡°ì ˆ. (ì˜ˆ: ì¶©ëŒ ì§í›„ì—” $w_1$ ì¦ê°€, í­ì—¼ ì‹œì—” $w_3$ ì¦ê°€).

---

## 5. ê²°ë¡  (Conclusion)

ë³¸ Decision LayerëŠ” ë‹¨ìˆœí•œ ì´ë¡ ì  ëª¨ë¸ë§ì´ ì•„ë‹Œ, **ê²€ì¦ëœ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬(PyG, Timm, SB3)**ì™€ **ìµœì‹  í•™ìŠµ ê¸°ë²•(Knowledge Distillation, PINN)**ì„ ê²°í•©í•˜ì—¬ ì„¤ê³„ë˜ì—ˆë‹¤.
íŠ¹íˆ **ê°•í™”í•™ìŠµ ê¸°ë°˜ì˜ ëŠ¥ë™ ì œì–´(Active Control)** ê¸°ëŠ¥ì€ ì—ì´ì „íŠ¸ê°€ ë¶ˆì•ˆì •í•œ ë¬´ì„  í†µì‹  í™˜ê²½ì„ ìŠ¤ìŠ¤ë¡œ ê·¹ë³µí•˜ê³ , ì¸ê°„ ìˆ˜ì¤€ì˜ ìƒí™© íŒë‹¨ì„ ë‚´ë¦´ ìˆ˜ ìˆê²Œ í•˜ëŠ” í•µì‹¬ ì°¨ë³„ì ì´ë‹¤.

---

## 6. ì°¸ê³  ë¬¸í—Œ (References)

1.  **"PointNet++: Deep Hierarchical Feature Learning on Point Sets in a Metric Space"** (NIPS 2017).
2.  **"EfficientNetV2: Smaller Models and Faster Training"** (ICML 2021).
3.  **"Physics-Informed Neural Networks: A Deep Learning Framework"** (J. Comput. Phys., 2019).
4.  **"Proximal Policy Optimization Algorithms"** (OpenAI, 2017).
5.  **"Cross-Modal Knowledge Distillation for Vision-to-Sensor Transfer"** (CVPR).

---
*Created by [Your Name] for 6G-Guardian Project.*
